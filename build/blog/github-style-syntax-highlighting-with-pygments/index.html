<!doctype html>
<html>
  <head>
    <meta content='IE=edge' http-equiv='X-UA-Compatible'>
    <meta charset='utf-8'>
    <meta content='width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no' name='viewport'>
    <meta name='description' content="Update 2016: This tutorial is out-of-date. See the repository for  alexpeattie.com and the associated README to see how I do it now.">
    

    <title>GitHub-style syntax highlighting with Pygments - Alex Peattie</title>

    <link href='//fonts.googleapis.com/css?family=Lato:300,400' rel='stylesheet' type='text/css'>

    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32-18545059.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192-62275dc0.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16-13aa2390.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab-b8c45f01.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ff0000">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ff0000">

    <link href="/assets/css/all-a7a0038a.css" rel="stylesheet" />
    <script src="/assets/js/all-a1da6af5.js"></script>
  </head>

  <body class='blog blog_github-style-syntax-highlighting-with-pygments blog_github-style-syntax-highlighting-with-pygments_index'>
    <header>
  <nav class='MainMenu'>
    <a href='/' class='Logo'>
      <span>emil</span>karlsson
    </a>

    <a class='NavBtn NavBtn--mobileOnly' data-toggle-modal-menu>Menu</a>

    <section class='MainMenu-links'>
      <a href='/' class='NavBtn' id='NavBtnAbout'>About Me</a>
      <a href='/projects' class='NavBtn' id='NavBtnProjects'>Projects</a>
    <!-- <a href='/talks' class='NavBtn' id='NavBtnTalks'>Talks</a> -->
    <!-- <a href='/blog' class='NavBtn' id='NavBtnBlog'>Blog</a> -->

      <a class='NavBtn NavBtn--close' data-toggle-modal-menu>✕</a>
    </nav>
  </nav>

  
</header>


    <main>
        <article class='ContentBody'>
    <h1>GitHub-style syntax highlighting with Pygments</h1>
    <h2 class='PostMeta'>
      <time datetime="2012-04-08" pubdate="true">8th April 2012</time> – 
      <a href='#comments' data-disqus-url='http://alexpeattie.com/blog/github-style-syntax-highlighting-with-pygments/'>comments</a>
    </h2>
    <div class="Callout"><p><strong>Update 2016</strong>: This tutorial is out-of-date. See the <a href="https://github.com/alexpeattie/alexpeattie.com">repository for  alexpeattie.com</a> and the <a href="https://github.com/alexpeattie/alexpeattie.com#syntax-highlighting">associated README</a> to see how I do it now.</p></div>

<p>A few people have asked me how I do the Github-style syntax highlighting on this site. Here's an example Ruby script with highlighting:</p>

<div class="codehilite ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21</pre></td><td class="code"><pre><span class="k">class</span> <span class="nc">A</span> <span class="o">&lt;</span> <span class="no">B</span><span class="p">;</span> <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">create</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="no">User</span><span class="p">)</span> <span class="n">object</span> <span class="k">end</span> <span class="k">end</span>
<span class="k">class</span> <span class="nc">Zebra</span><span class="p">;</span> <span class="k">def</span> <span class="nf">inspect</span><span class="p">;</span> <span class="s2">"X</span><span class="si">#{</span><span class="mi">2</span> <span class="o">+</span> <span class="nb">self</span><span class="p">.</span><span class="nf">object_id</span><span class="si">}</span><span class="s2">"</span> <span class="k">end</span> <span class="k">end</span>

<span class="k">module</span> <span class="nn">ABC::DEF</span>
  <span class="kp">include</span> <span class="no">Comparable</span>

  <span class="c1"># @param test</span>
  <span class="c1"># @return [String] nothing</span>
  <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="nb">test</span><span class="p">)</span>
    <span class="no">Thread</span><span class="p">.</span><span class="nf">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">blockvar</span><span class="o">|</span>
      <span class="no">ABC</span><span class="o">::</span><span class="no">DEF</span><span class="p">.</span><span class="nf">reverse</span><span class="p">(</span><span class="ss">:a_symbol</span><span class="p">,</span> <span class="ss">:'a symbol'</span><span class="p">,</span> <span class="ss">:&lt;=&gt;</span><span class="p">,</span> <span class="s1">'test'</span> <span class="o">+</span> <span class="nb">test</span><span class="p">)</span>
    <span class="k">end</span><span class="p">.</span><span class="nf">join</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">[]</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="nb">self</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">end</span>
  <span class="k">def</span> <span class="nf">==</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="n">other</span> <span class="o">==</span> <span class="nb">self</span> <span class="k">end</span>
<span class="k">end</span>

<span class="n">anIdentifier</span> <span class="o">=</span> <span class="n">an_identifier</span>
<span class="no">Constant</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">render</span> <span class="ss">action: :new</span>
</pre></td></tr></tbody></table>
</div>
<p>This how-to explains my setup on Middleman (which this site is built on), but it should be applicable to any site using <a href="http://pygments.org/">Pygments</a> for syntax highlighting.</p>

<p>To enable basic syntax highlighting, we need to add the middleman-syntax gem to our <code>Gemfile</code>:</p>

<div class="codehilite ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">gem</span> <span class="s2">"middleman-syntax"</span>
</pre></td></tr></tbody></table>
</div>

<p>and activate it in our <code>config.rb</code>:</p>

<div class="codehilite ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">activate</span> <span class="ss">:syntax</span>
</pre></td></tr></tbody></table>
</div>

<p>We'll also turn on the <code>lineanchors</code> option, which we'll need for line numbering (<a href="#line-numbers">see below</a>).</p>

<div class="codehilite ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">activate</span> <span class="ss">:syntax</span><span class="p">,</span> <span class="ss">lineanchors: </span><span class="s1">'line'</span>
</pre></td></tr></tbody></table>
</div>

<h2 id="fenced-code-blocks">Fenced code blocks</h2>

<p>The first feature we'll add is fenced code blocks, a feature of <a href="http://github.github.com/github-flavored-markdown/">Github Flavored Markdown</a>. This allows us to conveniently specify the language (and thus, the <a href="http://pygments.org/docs/lexers/">Pygments lexer</a>) of our code:</p>

<div class="codehilite plaintext"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>~~~ruby
puts "Hello world from ruby"
~~~
</pre></td></tr></tbody></table>
</div>

<p>We'll need to change our Markdown pre-processor to Redcarpet which supports fenced code blocks. We need to add:</p>

<div class="codehilite ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="n">gem</span> <span class="s2">"redcarpet"</span>
</pre></td></tr></tbody></table>
</div>

<p>to our <code>Gemfile</code> and put the following into our <code>config.rb</code>:</p>

<div class="codehilite ruby"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre><span class="n">set</span> <span class="ss">:markdown_engine</span><span class="p">,</span> <span class="ss">:redcarpet</span>
<span class="n">set</span> <span class="ss">:markdown</span><span class="p">,</span> <span class="ss">fenced_code_blocks: </span><span class="kp">true</span>
</pre></td></tr></tbody></table>
</div>

<h2 id="github-highlighting-color-scheme">Github highlighting color scheme</h2>

<p>Next we'll add some CSS to match Github's color scheme: <a href="https://github.com/richleland/pygments-css/blob/master/github.css">https://github.com/richleland/pygments-css/blob/master/github.css</a></p>

<p>We have to make one small change, <code>.hll</code> needs to be replaced with <code>.highlight</code></p>

<div class="codehilite css"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre><span class="nc">.hll</span> <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#ffffcc</span> <span class="p">}</span> <span class="c">/* WRONG */</span>
<span class="nc">.highlight</span> <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#ffffcc</span> <span class="p">}</span> <span class="c">/* RIGHT */</span>
</pre></td></tr></tbody></table>
</div>

<h2 id="line-numbers">Line numbers</h2>

<p>The last thing we're missing are line-numbers. We'll implement this in pure CSS, using <a href="https://developer.mozilla.org/en-US/docs/CSS/Counters">CSS counters</a>:</p>

<div class="codehilite css"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</pre></td><td class="code"><pre><span class="nt">pre</span> <span class="p">{</span>
    <span class="nl">counter-reset</span><span class="p">:</span> <span class="n">line-numbering</span><span class="p">;</span>
    <span class="nl">border</span><span class="p">:</span> <span class="nb">solid</span> <span class="m">1px</span> <span class="m">#d9d9d9</span><span class="p">;</span>
    <span class="nl">border-radius</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
    <span class="nl">background</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span>
    <span class="nl">padding</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
    <span class="nl">line-height</span><span class="p">:</span> <span class="m">23px</span><span class="p">;</span>
    <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">30px</span><span class="p">;</span>
    <span class="nl">white-space</span><span class="p">:</span> <span class="n">pre</span><span class="p">;</span>
    <span class="nl">overflow-x</span><span class="p">:</span> <span class="nb">auto</span><span class="p">;</span>
    <span class="nl">word-break</span><span class="p">:</span> <span class="nb">inherit</span><span class="p">;</span>
    <span class="nl">word-wrap</span><span class="p">:</span> <span class="nb">inherit</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">pre</span> <span class="nt">a</span><span class="nd">::before</span> <span class="p">{</span>
  <span class="nl">content</span><span class="p">:</span> <span class="n">counter</span><span class="p">(</span><span class="n">line-numbering</span><span class="p">);</span>
  <span class="nl">counter-increment</span><span class="p">:</span> <span class="n">line-numbering</span><span class="p">;</span>
  <span class="nl">padding-right</span><span class="p">:</span> <span class="m">1em</span><span class="p">;</span> <span class="c">/* space after numbers */</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">25px</span><span class="p">;</span>
  <span class="nl">text-align</span><span class="p">:</span> <span class="nb">right</span><span class="p">;</span>
  <span class="nl">opacity</span><span class="p">:</span> <span class="m">0.7</span><span class="p">;</span>
  <span class="nl">display</span><span class="p">:</span> <span class="n">inline-block</span><span class="p">;</span>
  <span class="nl">color</span><span class="p">:</span> <span class="m">#aaa</span><span class="p">;</span>
  <span class="nl">background</span><span class="p">:</span> <span class="m">#eee</span><span class="p">;</span>
  <span class="nl">margin-right</span><span class="p">:</span> <span class="m">16px</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">2px</span> <span class="m">10px</span><span class="p">;</span>
  <span class="nl">font-size</span><span class="p">:</span> <span class="m">13px</span><span class="p">;</span>
  <span class="nl">-webkit-touch-callout</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
  <span class="nl">-webkit-user-select</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
  <span class="nl">-khtml-user-select</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
  <span class="nl">-moz-user-select</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
  <span class="nl">-ms-user-select</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
  <span class="py">user-select</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">pre</span> <span class="nt">a</span><span class="nd">:first-of-type::before</span> <span class="p">{</span>
  <span class="nl">padding-top</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">pre</span> <span class="nt">a</span><span class="nd">:last-of-type::before</span> <span class="p">{</span>
  <span class="nl">padding-bottom</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">pre</span> <span class="nt">a</span><span class="nd">:only-of-type::before</span> <span class="p">{</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table>
</div>

<p>Notice the <code>user-select: none;</code> - this ensures that when the code is selected, the line numbers won't be selected too, which makes copying and pasting a lot more convenient.</p>

<p>CSS counters will work fine for <a href="http://caniuse.com/css-counters">~95% of users</a> - and older browsers will degrade gracefully (they just won't show any line numbers).</p>

  </article>
  
  <article class='Comments'>
  <h2 id='comments'>Comments</h2>

  <div id='disqus_thread'>
  </div>

  <script>
    var disqus_shortname = 'alexpeattie';
    var disqus_url = 'http://alexpeattie.com/blog/github-style-syntax-highlighting-with-pygments/';
    var disqus_identifier = '2012 04 08 github style syntax highlighting with pygments';

    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
      var s = document.createElement('script'); s.async = true; s.type = 'text/javascript';
      s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq).appendChild(s);
    })();
  </script>
</article>

    </main>

    <section class='SourceCallout'>
    <!--  <p>This site is open-source (<a href='/projects#site'>more info</a>) - here's <a href="https://github.com/alexpeattie/alexpeattie.com/blob/master/source/blog/2012-04-08-github-style-syntax-highlighting-with-pygments.html.md">the source code for this page</a></a>.</p>-->
    </section>

    <footer>
      <p>© 2018 Emil Karlsson. Questions? Email <a href='mailto:me@emilingemarkarlsson@gmail.com'>emilingemarkarlsson@gmail.com</a>
      </p>
    </footer>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-116235734-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>
